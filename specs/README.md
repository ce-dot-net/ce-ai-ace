# ACE Playbooks (spec-kit Format)

This directory contains human-readable, version-controlled playbooks generated by ACE (Agentic Context Engineering).

## 📁 Structure

```
specs/
├── memory/
│   └── constitution.md          # High-confidence principles (≥70%)
└── playbooks/
    ├── 001-python-io/
    │   ├── spec.md              # Pattern definition
    │   ├── plan.md              # Technical approach
    │   └── insights.md          # Reflector analysis
    ├── 002-python-strings/
    └── 003-typescript-typing/
```

## 🎯 What Are Playbooks?

Playbooks are **learned coding patterns** that ACE automatically discovers from your codebase:

- **Detected** by analyzing your code (AST + regex)
- **Validated** through test results and execution feedback
- **Curated** using research-proven algorithms (85% similarity threshold)
- **Evolved** through multi-epoch training and refinement

## 📖 File Types

### `spec.md` - Pattern Definition
Contains the pattern overview with YAML frontmatter:
- Pattern ID and metadata
- Description and statistics
- When to use/avoid
- Confidence score and observations

### `plan.md` - Technical Approach
Describes how to apply the pattern:
- Implementation approach
- Success criteria
- Latest insights from Reflector
- Examples and best practices

### `insights.md` - Reflector Analysis
Historical analysis from ACE's Reflector agent:
- Real-world usage insights
- Common mistakes
- Effectiveness analysis
- Recommendations for improvement

## 🔄 How Playbooks Evolve

1. **You code** → ACE detects patterns
2. **Tests run** → ACE analyzes effectiveness
3. **Reflector analyzes** → Insights generated
4. **Curator merges** → Playbooks updated
5. **Git commits** → History preserved

## 📊 Constitution

`memory/constitution.md` contains **high-confidence principles** (≥70% confidence) that represent your codebase's core coding standards.

Think of it as your team's automatically-learned style guide.

## 🔍 Finding Patterns

### By ID
Each playbook has a unique ID (e.g., `py-004`):
```bash
# Find by ID
grep -r "pattern_id: py-004" specs/playbooks/
```

### By Domain
Patterns are organized by domain:
```bash
# List all python-io patterns
ls specs/playbooks/*python-io*/
```

### By Language
```bash
# Find all Python patterns
grep -r "language: python" specs/playbooks/*/spec.md
```

## 🚀 Usage

### Reading Playbooks
Playbooks are human-readable markdown files:
```bash
# Read a pattern
cat specs/playbooks/001-python-io/spec.md

# Read constitution
cat specs/memory/constitution.md
```

### Context Injection
ACE automatically injects relevant playbooks into agent context based on the file you're editing.

### Version Control
**These files are committed to git!**

This enables:
- Team-wide pattern sharing
- Historical pattern evolution
- Cross-machine synchronization
- Rollback capabilities
- Git-based offline training

## 🧪 Confidence Levels

- **≥70%**: High-confidence (included in constitution)
- **30-70%**: Medium-confidence (under validation)
- **<30%**: Low-confidence (may be pruned)

## 🎓 Research Background

Based on:
**"Agentic Context Engineering: Evolving Contexts for Self-Improving Language Models"**
- [arXiv:2510.04618](https://arxiv.org/abs/2510.04618)
- Stanford University, SambaNova Systems, UC Berkeley

### Key Innovations
- **Incremental delta updates** prevent context collapse
- **Semantic embeddings** (85% similarity threshold)
- **Deterministic curation** (no LLM variance)
- **Multi-epoch training** (+2.6% improvement)

## 💡 Commands

```bash
# View statistics
/ace-status

# List patterns
/ace-patterns [domain] [min-confidence]

# Export patterns
/ace-export-speckit 001-python-io

# Force reflection
/ace-force-reflect [file]

# Run offline training
/ace-train-offline
```

## 🔗 Related

- **SQLite Database**: `.ace-memory/patterns.db` (learning engine, gitignored)
- **Legacy Format**: `CLAUDE.md` (optional, for backward compatibility)
- **Pattern Detection**: `scripts/serena-pattern-detector.py`
- **Generator**: `scripts/generate-speckit-playbook.py`

## 🤝 Contributing

Playbooks are **auto-generated** from learned patterns. To improve them:

1. **Write better code** → ACE learns better patterns
2. **Write tests** → Patterns get validated
3. **Use patterns consistently** → Confidence increases
4. **Review PRs** → Catch pattern changes before merging

## 📚 Learn More

- [ACE Implementation Guide](../docs/ACE_IMPLEMENTATION_GUIDE.md)
- [ACE Research Summary](../docs/ACE_RESEARCH.md)
- [Main README](../README.md)

---

*Auto-maintained by ACE (Agentic Context Engineering)*
*This directory represents your codebase's learned wisdom*
